Bootstrap: docker
From: nvidia/cuda:12.8.0-cudnn-devel-ubuntu22.04

%post
    apt-get -y update
    apt-get -y install curl wget lsb-release gnupg
    # add packages
    curl https://packages.osrfoundation.org/gazebo.gpg --output /usr/share/keyrings/pkgs-osrf-archive-keyring.gpg
    echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/pkgs-osrf-archive-keyring.gpg] http://packages.osrfoundation.org/gazebo/ubuntu-stable $(lsb_release -cs) main" | tee /etc/apt/sources.list.d/gazebo-stable.list > /dev/null
    apt-get -y update
    sh -c 'echo "deb http://packages.osrfoundation.org/gazebo/ubuntu-stable `lsb_release -cs` main" > /etc/apt/sources.list.d/gazebo-stable.list'
    wget https://packages.osrfoundation.org/gazebo.key -O - | apt-key add -
    apt-get -y update
    # python
    apt-get -y install git nano
    apt-get -y install python3 
    apt-get -y install python3-pip
    apt -y install liborocos-kdl1.5:amd64=1.5.1-2build1
    #apt -y install python3-numpy=1:1.21.5-1ubuntu22.04.1
    apt -y install python3-pykdl:amd64=1.5.1-2build1
    python3 -m pip install numpy scipy scikit-learn tensorflow===2.19.0 keras
    python3 -m pip install tensorflow_datasets pandas matplotlib argparse tensorflow_addons imageio
    # gazebo
    apt-get -y install gz-harmonic
    # for EGL/--headless rendering
    apt-get -y install libnvidia-gl-535
    # gz-transport
    apt-get -y install libgz-transport13-dev

%environment
    #export LC_ALL=C
    #export PATH=/usr/games:$PATH

%runscript
    #fortune | cowsay | lolcat
    echo "HELLO"
